# Generated by Hossein Mohammadi on 2021-01-01

#_________________11111
#___________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶11
#_________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
#________¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶1
#_______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
#______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶1
#_____¶¶¶¶¶¶¶¶¶11111¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶
#___¶¶¶¶1___________________¶¶¶¶¶¶¶¶¶¶¶¶¶¶
#_¶¶¶__________________________1¶¶¶¶¶¶¶¶¶¶¶
#_¶1______________________________1¶¶¶¶¶¶¶¶¶
#1¶__________111_____________________¶¶¶¶¶¶¶¶
#1¶______¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶1___________¶¶¶¶¶¶¶¶
#_¶___¶¶¶¶1_____________1¶¶¶¶¶1______1¶¶¶¶¶¶¶
#_¶1_¶¶¶¶__1¶¶¶¶¶¶_____11111¶¶¶¶_____¶¶¶¶¶¶¶¶
#__¶¶¶¶¶11¶¶¶¶¶¶¶¶¶___¶¶¶¶¶¶¶¶1¶¶¶1__¶¶¶¶¶¶¶¶
#___¶¶¶¶____1¶¶¶¶¶1___¶¶1¶¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶
#___¶11¶______¶1¶¶_____¶1¶1_____¶¶¶¶¶¶¶¶¶¶¶¶¶
#___¶__¶1_______¶1_____¶1_______¶¶¶1_¶¶¶¶¶¶¶1
#___¶__¶¶1___11¶¶¶1___¶¶¶1______¶¶¶¶__¶¶¶¶¶¶
#___¶___¶¶¶¶¶¶111¶¶¶¶¶¶1_¶¶¶¶¶¶¶¶_¶¶__¶¶¶¶¶¶
#__1¶____¶¶_________1________1¶1___¶___¶¶¶¶1
#__1¶______1____1¶¶¶¶¶¶¶1__________¶1__¶¶¶¶¶
#__1¶_______¶¶¶¶¶¶_____¶¶¶¶¶¶______¶1_¶¶___¶¶
#___¶______________111_____________¶1¶¶_____1¶
#___¶1_____________________________¶1¶_______¶
#___¶¶____________________________¶¶_¶¶______¶
#____¶1___________________________¶___¶¶¶11¶¶_
#_____¶1_________________________¶¶_____11____
#______¶¶_______________________¶¶____________
#_______¶¶_____________________¶¶_____________
#________1¶¶_________________1¶_______________
#__________¶¶1_____________1¶¶________________
#____________¶¶¶________1¶¶¶__________________
#______________1¶¶111¶¶¶1_____________________


from django.db import migrations, models
import django.db.models.deletion

CACHED_APPLYDATA_SEMESTER_YEARS = {

}

def _get_new_semester_years(apps, schema_editor, old_ones:iter):
    ApplyDataSemesterYear = apps.get_model("applydata", "semesteryear")
    new_ones = []
    for old_one in old_ones:
        identifier = str(old_one.year)+'_||_'+old_one.semester
        if identifier not in CACHED_APPLYDATA_SEMESTER_YEARS:
            obj = ApplyDataSemesterYear.objects.get(semester=old_one.semester, year=old_one.year)
            CACHED_APPLYDATA_SEMESTER_YEARS[identifier] = obj
        new_ones.append(CACHED_APPLYDATA_SEMESTER_YEARS[identifier])


def forwards_func(apps, schema_editor):
    # We get the model from the versioned app registry;
    # if we directly import it, it'll be the wrong version
    FormWantToApply = apps.get_model("form", "wanttoapply")
    FormWantToApplyTransferSemesterGrade = apps.get_model("form", "wanttoapplytransfersemestergrade")
    for obj in FormWantToApply.objects.all():
        mid_obj = FormWantToApplyTransferSemesterGrade.objects.create(
            want_to_apply=obj,
        )
        mid_obj.form_semester_years.set([obj.semester_years])
        mid_obj.form_grades.set([obj.grades])


class Migration(migrations.Migration):

    dependencies = [
        ('form', '0019_create_temp_wanttoapplytransfer'),
    ]

    operations = [
        migrations.RunPython(
            code=forwards_func,
        ),
    ]